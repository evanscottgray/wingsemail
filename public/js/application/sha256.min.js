/* A JavaScript implementation of the Secure Hash Algorithm, SHA-256
 * Version 0.3 Copyright Angel Marin 2003-2004 - http://anmar.eu.org/
 * Distributed under the BSD License
 * Some bits taken from Paul Johnston's SHA-1 implementation
 */
function safe_add(e,a){var r=(65535&e)+(65535&a),n=(e>>16)+(a>>16)+(r>>16);return n<<16|65535&r}function S(e,a){return e>>>a|e<<32-a}function R(e,a){return e>>>a}function Ch(e,a,r){return e&a^~e&r}function Maj(e,a,r){return e&a^e&r^a&r}function Sigma0256(e){return S(e,2)^S(e,13)^S(e,22)}function Sigma1256(e){return S(e,6)^S(e,11)^S(e,25)}function Gamma0256(e){return S(e,7)^S(e,18)^R(e,3)}function Gamma1256(e){return S(e,17)^S(e,19)^R(e,10)}function core_sha256(e,a){var r,n,t,s,d,o,f,i,u,c,l,h,_=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],w=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],m=Array(64);e[a>>5]|=128<<24-a%32,e[(a+64>>9<<4)+15]=a;for(var u=0;e.length>u;u+=16){r=w[0],n=w[1],t=w[2],s=w[3],d=w[4],o=w[5],f=w[6],i=w[7];for(var c=0;64>c;c++)m[c]=16>c?e[c+u]:safe_add(safe_add(safe_add(Gamma1256(m[c-2]),m[c-7]),Gamma0256(m[c-15])),m[c-16]),l=safe_add(safe_add(safe_add(safe_add(i,Sigma1256(d)),Ch(d,o,f)),_[c]),m[c]),h=safe_add(Sigma0256(r),Maj(r,n,t)),i=f,f=o,o=d,d=safe_add(s,l),s=t,t=n,n=r,r=safe_add(l,h);w[0]=safe_add(r,w[0]),w[1]=safe_add(n,w[1]),w[2]=safe_add(t,w[2]),w[3]=safe_add(s,w[3]),w[4]=safe_add(d,w[4]),w[5]=safe_add(o,w[5]),w[6]=safe_add(f,w[6]),w[7]=safe_add(i,w[7])}return w}function str2binb(e){for(var a=[],r=(1<<chrsz)-1,n=0;e.length*chrsz>n;n+=chrsz)a[n>>5]|=(e.charCodeAt(n/chrsz)&r)<<24-n%32;return a}function binb2hex(e){for(var a=0,r=a?"0123456789ABCDEF":"0123456789abcdef",n="",t=0;4*e.length>t;t++)n+=r.charAt(15&e[t>>2]>>8*(3-t%4)+4)+r.charAt(15&e[t>>2]>>8*(3-t%4));return n}function hex_sha256(e){return binb2hex(core_sha256(str2binb(e),e.length*chrsz))}var chrsz=8;